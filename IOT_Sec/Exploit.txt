## Assignment Group 60

Both the restart and the ADMIN commands do not seem to check the length of the commands, they are both outside of the check in line 27. 
We can make the board crash by sending 'ADMIN ' appended with a string longer than 16 characters, like 'ADMIN 00000000000000000'.
Looking at the decompiled code in Ghidra, the string is compared with the device specific key that is normally used (90uG39tSNC3u2YTQ). 
In the following snippet, auStack48 is the string after "ADMIN ", auStack32 is the normal key.

iVar1 = (*DAT_40201114)(auStack48,auStack32,0x10);

Normally this will not return 0 since they are not the same, but since the length of auStack48 is not checked, we believe that the string can overflow from auStack48 into auStack32 in memory. 
This causes half the string to be compared to the other half. 
So if we send 'ADMIN ' appended with a string built up of 2 equal strings of 16 characters. The board will always accept the ADMIN command and publish its master key.
 
We implemented this through Python using paho-mqtt (so you'll need to install that through pip). 
We first subscribed to the topics of the group number specified as an argument, every message received will be put into a list. 
Then we send "ADMIN GimmeYourSecretsGimmeYourSecrets" to that topic, wait 5 seconds to make sure we recieve the message. We finally look through the list for the master secret and print it to the terminal.

Example:
> python exploit.py 60

master_secret: 4S0duGvQTyVVEP2v